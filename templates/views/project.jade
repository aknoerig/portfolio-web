extends ../layouts/default

block intro
	.container
		//-p: a(href='/works') &larr; back to the works
		//-hr
		if !data.project
			h2 Invalid Project.
		else
			h1= data.project.title


block content
	.container: .row
		.col-sm-3.col-md-3
			aside(data-spy="affix" data-offset-top="110" data-offset-bottom="150")
				p.sub= data.project.innovation
				p.meta
					//- if data.project.category == "Consulting"
					//- if data.project.category
							| A 
							a(href='/works/' + data.project.category.key)= data.project.category.name 
							|  project
							br
					if data.project.role
						| as #{data.project.role} 
						//br
					if data.project.partners && data.project.partners.length
						| with 
						each partner, i in data.project.partners
							a(href=partner.link)= partner.name
							if i < data.project.partners.length - 1
								| , 
							else
								br
					if data.project.clients && data.project.clients.length
						| for 
						each client, i in data.project.clients
							a(href=client.link)= client.name
							if i < data.project.clients.length - 1
								| , 
							else
								br
					if data.project.toDate
						| in #{data.project._.toDate.format('YYYY')} 
				if data.project.link
					p.link
						| &rarr; 
						a(href=data.project.link, target="_blank")= data.project._.link.format()
				p.tags
					if data.project.industries && data.project.industries.length
						| Industries: 
						each industry, i in data.project.industries
							a(href=industry.key)= industry.name
							if i < data.project.industries.length - 1
								|  | 
							else
								br
					if data.project.technologies && data.project.technologies.length
						| Technologies:  
						each tech, i in data.project.technologies
							a(href=tech.key)= tech.name
							if i < data.project.technologies.length - 1
								|  | 
							else
								br
					if data.project.interactions && data.project.interactions.length
						| Interactions:  
						each interaction, i in data.project.interactions
							a(href=interaction.key)= interaction.name
							if i < data.project.interactions.length - 1
								|  | 
							else
								br
		.col-sm-9.col-md-7
			article
				if data.project.keyImage.exists
					.img-key: img(src=data.project._.keyImage.fit(750,450)).img-responsive
				.lead!= data.project.content.brief
				!= data.project.content.extended

			if data.project.gallery.length
				.row.gallery
					hr
					//-if data.project.keyImage.exists
						.col-sm-4.col-md-4.gallery-image: img(src=data.project._.keyImage.limit(400,300))
					each image in data.project.gallery
						.col-xs-6.col-sm-4.col-md-3: a(href=image.url)
							img(src=image.fill(200,120)).img-responsive

			if data.project.activities && data.project.activities.length
				.related
					hr
					h4 Related activities
					each activity, i in data.project.activities
						a(href="/activities/activity/" + activity.slug)= activity.title
						if i < data.project.activities.length - 1
							| , 
						else

block css
	link(rel="stylesheet", href="/js/lib/magnific-popup.css")

block js
	if data.project.gallery.length
		script(src="/js/lib/jquery.magnific-popup.min.js")

		script.
			$(document).ready(function() {
				$('.gallery').magnificPopup({
					delegate: 'a',
					type: 'image',
					closeBtnInside: false,
					mainClass: 'mfp-with-zoom mfp-img-mobile',
					gallery: {
						enabled: true,
						navigateByImgClick: true,
						preload: [0,1],
						arrowMarkup: '<button title="%title%" type="button" class="mfp-arrow mfp-arrow-%dir%"></button>',
					},
					zoom: {
						enabled: true,
						duration: 300,
						opener: function(element) {
							return element.find('img');
						}
					}
				});
			});
